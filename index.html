<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>$SLEEPMAN — Enter the Dream</title>
  <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
  <script type="module">
    async function loadEthers() {
      try {
        const { ethers } = await import('./ethers.js');
        window.ethers = ethers;
        console.log("ethers.js loaded successfully via local ES module");
      } catch (error) {
        console.error("Failed to load ethers.js:", error);
        try {
          const { ethers } = await import('https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.esm.min.js');
          window.ethers = ethers;
          console.log("ethers.js loaded successfully via CDN ES module");
        } catch (fallbackError) {
          console.error("Failed to load ethers.js from fallback:", fallbackError);
        }
      }
    }
    loadEthers();
  </script>
  <script src="https://unpkg.com/@thirdweb-dev/sdk@3"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'VT323', monospace;
      background: black;
      color: #00ffcc;
      overflow: hidden;
    }

    /* Intro Screen */
    #introScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: black;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 2rem;
    }

    .intro-text {
      color: #00ffcc;
      font-size: 2rem;
      opacity: 0;
      transform: translateY(20px);
      text-shadow: 0 0 10px #00ffcc;
    }

    .intro-text:nth-child(1) {
      animation: fadeInUp 2s ease forwards;
    }

    .intro-text:nth-child(2) {
      animation: fadeInUp 2s ease forwards 2.5s;
    }

    .intro-text:nth-child(3) {
      animation: fadeInUp 2s ease forwards 5s;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Main Content */
    #mainContent {
      opacity: 0;
      transition: opacity 1s ease;
    }

    #mainContent.visible {
      opacity: 1;
    }

    .background {
      position: fixed;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .ui {
      position: absolute;
      top: 50%;
      left: 10%;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    /* Main Menu Button Styles */
    .button {
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid #00ffcc;
      padding: 10px 20px;
      font-size: 24px;
      cursor: pointer;
      text-align: center;
      width: 280px;
      text-transform: uppercase;
      color: #00ffcc;
      box-shadow: 0 0 10px #00ffcc;
      text-shadow: 0 0 5px #00ffcc;
      position: relative;
      transition: all 0.2s ease;
    }

    .button::before {
      content: attr(data-text);
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      color: #00ffcc;
      filter: blur(1px);
      transform: scale(1.1);
      pointer-events: none;
    }

    .button:hover {
      animation: buttonGlitch 0.2s infinite;
      box-shadow: 
        0 0 10px #00ffcc,
        0 0 20px #00ffcc,
        0 0 30px #00ffcc;
      text-shadow: 
        0 0 5px #00ffcc,
        0 0 10px #00ffcc,
        0 0 15px #00ffcc;
      letter-spacing: 1px;
    }

    .button:hover::before {
      animation: textGlitch 0.3s infinite;
      opacity: 0.8;
    }

    @keyframes buttonGlitch {
      0% { transform: translate(0); }
      20% { transform: translate(-2px, 0); }
      40% { transform: translate(2px, 0); }
      60% { transform: translate(-1px, 0); }
      80% { transform: translate(1px, 0); }
      100% { transform: translate(0); }
    }

    @keyframes textGlitch {
      0% { 
        clip-path: inset(0 0 0 0);
        transform: translate(0);
        opacity: 1;
      }
      2% { 
        clip-path: inset(20% 0 0 0);
        transform: translate(-2px);
        opacity: 0.8;
      }
      4% { 
        clip-path: inset(0 0 20% 0);
        transform: translate(2px);
        opacity: 0.9;
      }
      6% { 
        clip-path: inset(0 0 0 0);
        transform: translate(0);
        opacity: 1;
      }
      100% { 
        clip-path: inset(0 0 0 0);
        transform: translate(0);
        opacity: 1;
      }
    }

    .terminal-line.repeat-message {
      color: #00ff66;
    }

    /* Sound effect hook for future use */
    .button[data-sound] {
      transition: all 0.2s ease;
    }

    .button[data-sound]:hover {
      /* Hook for future sound implementation */
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      z-index: 2000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal.active {
      opacity: 1;
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.95);
      padding: 2rem;
      border-radius: 5px;
      border: 2px solid #00ff00;
      text-align: center;
      max-width: 600px;
      width: 90%;
      animation: borderPulse 2s infinite;
      box-shadow: 
        0 0 20px rgba(0, 255, 0, 0.5),
        inset 0 0 20px rgba(0, 255, 0, 0.5);
      overflow: hidden;
    }

    @keyframes borderPulse {
      0% { border-color: #00ff00; box-shadow: 0 0 20px rgba(0, 255, 0, 0.5), inset 0 0 20px rgba(0, 255, 0, 0.5); }
      50% { border-color: #003300; box-shadow: 0 0 10px rgba(0, 255, 0, 0.2), inset 0 0 10px rgba(0, 255, 0, 0.2); }
      100% { border-color: #00ff00; box-shadow: 0 0 20px rgba(0, 255, 0, 0.5), inset 0 0 20px rgba(0, 255, 0, 0.5); }
    }

    .modal-title {
      color: #00ff00;
      font-size: 2.5rem;
      margin-bottom: 2rem;
      text-transform: uppercase;
      font-family: 'VT323', monospace;
      letter-spacing: 2px;
      animation: glitchText 0.4s infinite;
      position: relative;
      text-shadow: 
        2px 2px #003300,
        -2px -2px #00ff00;
    }

    @keyframes glitchText {
      0% { transform: translate(0); }
      20% { transform: translate(-2px, 2px); }
      40% { transform: translate(-2px, -2px); }
      60% { transform: translate(2px, 2px); }
      80% { transform: translate(2px, -2px); }
      100% { transform: translate(0); }
    }

    .modal-image-container {
      border: 1px solid #00ff00;
      padding: 1rem;
      margin: 1.5rem 0;
      background: rgba(0, 255, 0, 0.05);
      position: relative;
      min-height: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-image-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 255, 0, 0.1),
        rgba(0, 255, 0, 0.1) 1px,
        transparent 1px,
        transparent 2px
      );
      pointer-events: none;
      animation: scanline 10s linear infinite;
    }

    @keyframes scanline {
      0% { transform: translateY(0); }
      100% { transform: translateY(100%); }
    }

    .tokenomics-content {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      color: #00ff00;
      font-family: 'VT323', monospace;
      font-size: 1.2rem;
      width: 100%;
    }

    .tokenomics-item {
      display: flex;
      justify-content: space-between;
      border: 1px solid #00ff00;
      padding: 0.8rem 1rem;
      background: rgba(0, 255, 0, 0.05);
      opacity: 0;
      animation: fadeInGlitch 0.5s forwards, glitchItem 2s infinite;
    }

    .tokenomics-item:nth-child(1) { animation-delay: 0.3s; }
    .tokenomics-item:nth-child(2) { animation-delay: 0.6s; }
    .tokenomics-item:nth-child(3) { animation-delay: 0.9s; }
    .tokenomics-item:nth-child(4) { animation-delay: 1.2s; }
    .tokenomics-item:nth-child(5) { animation-delay: 1.5s; }

    @keyframes fadeInGlitch {
      0% {
        opacity: 0;
        transform: translateX(-10px);
      }
      50% {
        opacity: 0.5;
        transform: translateX(5px);
      }
      100% {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes glitchItem {
      0% { transform: translate(0); }
      1% { transform: translate(-2px); filter: brightness(150%); }
      2% { transform: translate(2px); filter: brightness(100%); }
      3% { transform: translate(0); }
      90% { transform: translate(0); }
      91% { transform: translate(-1px); filter: brightness(150%); }
      92% { transform: translate(1px); filter: brightness(100%); }
      93% { transform: translate(0); }
    }

    .modal-button {
      background: transparent;
      border: 2px solid #00ff00;
      padding: 12px 40px;
      font-size: 24px;
      cursor: pointer;
      color: #00ff00;
      text-transform: uppercase;
      margin-top: 2rem;
      font-family: 'VT323', monospace;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .modal-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(0, 255, 0, 0.2),
        transparent
      );
      animation: buttonGlow 3s infinite;
    }

    @keyframes buttonGlow {
      0% { left: -100%; }
      50% { left: 100%; }
      100% { left: 100%; }
    }

    .modal-button:hover {
      animation: buttonGlitch 0.3s infinite;
      background: rgba(0, 255, 0, 0.1);
      text-shadow: 0 0 8px #00ff00;
    }

    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: #00ff00;
      font-size: 28px;
      cursor: pointer;
      background: none;
      border: none;
      text-shadow: 0 0 5px #00ff00;
      padding: 5px 10px;
      animation: glitchText 1s infinite;
    }

    .close-modal:hover {
      animation: glitchText 0.2s infinite;
    }

    /* Scanline effect for the entire modal */
    .modal::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.1),
        rgba(0, 0, 0, 0.1) 1px,
        transparent 1px,
        transparent 2px
      );
      pointer-events: none;
      animation: scanline 10s linear infinite;
      z-index: 2001;
    }

    /* CRT flicker effect */
    .modal::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 255, 0, 0.03);
      pointer-events: none;
      animation: flicker 0.15s infinite;
      z-index: 2001;
    }

    @keyframes flicker {
      0% { opacity: 0.5; }
      50% { opacity: 1; }
      100% { opacity: 0.5; }
    }

    /* Info Button Styles */
    #info-button {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 40px;
      height: 40px;
      background: transparent;
      border: 1px solid #00ffcc;
      color: #00ffcc;
      font-family: 'VT323', 'IBM Plex Mono', 'Source Code Pro', monospace;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    #info-button:hover {
      box-shadow: 0 0 10px #00ffcc;
      text-shadow: 0 0 5px #00ffcc;
    }

    /* Typewriter effect styles */
    .typewriter-text {
      display: inline-block;
      overflow: hidden;
      white-space: pre-line;
      border-right: 2px solid #00ffcc;
      animation: blink 0.75s step-end infinite;
    }

    @keyframes blink {
      from, to { border-color: transparent }
      50% { border-color: #00ffcc; }
    }

    /* Info Modal Styles */
    #info-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      z-index: 2000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #info-modal.active {
      opacity: 1;
    }

    #info-modal .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #000;
      padding: 20px;
      border-radius: 5px;
      border: 2px solid #00ffcc;
      text-align: left;
      max-width: 600px;
      width: 90%;
      box-shadow: 0 0 20px rgba(0, 255, 204, 0.5);
      max-height: 80vh;
      overflow-y: auto;
      font-family: 'VT323', 'IBM Plex Mono', monospace;
      color: #00ffcc;
      line-height: 1.6;
    }

    #info-modal .modal-content::-webkit-scrollbar {
      width: 6px;
    }

    #info-modal .modal-content::-webkit-scrollbar-track {
      background: rgba(0, 255, 204, 0.1);
      border-radius: 3px;
    }

    #info-modal .modal-content::-webkit-scrollbar-thumb {
      background: #00ffcc;
      border-radius: 3px;
      box-shadow: 0 0 5px #00ffcc;
    }

    #info-modal .modal-content::-webkit-scrollbar-thumb:hover {
      background: #00ffcc;
      box-shadow: 0 0 8px #00ffcc;
    }

    #info-modal .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: #00ffcc;
      font-size: 28px;
      cursor: pointer;
      background: none;
      border: none;
      text-shadow: 0 0 5px #00ffcc;
      padding: 5px 10px;
      z-index: 1;
    }

    #info-modal .info-content {
      white-space: pre-line;
      font-size: 18px;
    }

    #info-modal .info-content p {
      margin: 0 0 1em 0;
    }

    /* Секретная кнопка по лампе */
    #secretLampBtn {
      position: fixed !important;
      bottom: 20px !important;
      right: 20px !important;
      width: 300px !important;
      height: 300px !important;
      background: url('FO3_Wall_terminal.webp') no-repeat center/contain !important;
      cursor: pointer !important;
      z-index: 9999 !important;
      filter: drop-shadow(0 0 25px rgba(0, 255, 0, 0.3)) !important;
      animation: terminalFloat 3s ease-in-out infinite !important;
      transition: all 0.3s ease !important;
    }

    @keyframes terminalFloat {
      0%, 100% {
        transform: translateY(0);
        filter: drop-shadow(0 0 25px rgba(0, 255, 0, 0.3));
      }
      50% {
        transform: translateY(-12px);
        filter: drop-shadow(0 0 35px rgba(0, 255, 0, 0.4));
      }
    }

    @keyframes glitch {
      0% {
        transform: translate(0);
        filter: hue-rotate(0deg);
      }
      20% {
        transform: translate(-2px, 2px);
        filter: hue-rotate(10deg);
      }
      40% {
        transform: translate(2px, -2px);
        filter: hue-rotate(-10deg);
      }
      60% {
        transform: translate(-2px);
        filter: hue-rotate(5deg);
      }
      80% {
        transform: translate(2px);
        filter: hue-rotate(-5deg);
      }
      100% {
        transform: translate(0);
        filter: hue-rotate(0deg);
      }
    }

    #secretLampBtn:hover {
      filter: drop-shadow(0 0 20px rgba(0, 255, 0, 0.6)) brightness(1.2) !important;
      animation: terminalFloat 3s ease-in-out infinite, glitch 0.3s steps(3) infinite !important;
    }

    /* Терминал */
    #terminal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 1200px;
      height: 900px;
      background: url('terminal_frame.png') no-repeat center center;
      background-size: contain;
      z-index: 999;
    }

    .terminal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 48%;
      height: 40%;
      background: transparent;
      color: #00ff66;
      font-family: 'VT323', 'Share Tech Mono', 'Courier New', monospace;
      font-size: 18px;
      line-height: 1.6;
      padding: 30px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: #00ff66 rgba(0, 255, 102, 0.1);
      border: 1px solid rgba(0, 255, 102, 0.2);
      box-shadow: inset 0 0 20px rgba(0, 255, 102, 0.1);
      margin-top: -105px;
      transition: color 0.3s ease;
    }

    /* Стилизация скроллбара для WebKit (Chrome, Safari) */
    .terminal-content::-webkit-scrollbar {
      width: 6px;
    }

    .terminal-content::-webkit-scrollbar-track {
      background: rgba(0, 255, 102, 0.1);
      border-radius: 3px;
    }

    .terminal-content::-webkit-scrollbar-thumb {
      background: #00ff66;
      border-radius: 3px;
      box-shadow: 0 0 5px #00ff66;
    }

    .terminal-content::-webkit-scrollbar-thumb:hover {
      background: #00ff99;
      box-shadow: 0 0 8px #00ff99;
    }

    .terminal-input-wrapper {
      position: absolute;
      bottom: 33%;
      left: 50%;
      transform: translateX(-50%);
      width: 48%;
      display: flex;
      align-items: center;
      gap: 10px;
      background: transparent;
      padding: 15px;
      border-top: 1px solid rgba(0, 255, 102, 0.3);
    }

    .terminal-prompt {
      color: #00ff66;
      font-family: 'VT323', 'Share Tech Mono', 'Courier New', monospace;
      font-size: 16px;
    }

    .terminal-input {
      flex-grow: 1;
      background: transparent;
      border: none;
      color: #00ff66;
      font-family: 'VT323', 'Share Tech Mono', 'Courier New', monospace;
      font-size: 16px;
      outline: none;
      caret-color: #00ff66;
    }

    .terminal-input::placeholder {
      color: rgba(0, 255, 102, 0.5);
    }

    .terminal-indicator {
      width: 8px;
      height: 8px;
      background: #00ff66;
      border-radius: 50%;
      margin-left: 10px;
      box-shadow: 0 0 5px #00ff66;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    .terminal-line {
      opacity: 0;
      transform: translateY(5px);
      transition: all 0.3s ease;
      margin-bottom: 5px;
    }

    .terminal-line.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Overlay for terminal background */
    .terminal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 998;
    }

    /* Добавляем анимацию тряски */
    @keyframes terminalShake {
      0%, 100% { transform: translate(-50%, -50%); }
      25% { transform: translate(-52%, -50%); }
      50% { transform: translate(-50%, -51%); }
      75% { transform: translate(-48%, -50%); }
    }

    .terminal-content.error {
      color: #ff2a2a;
      animation: terminalShake 0.2s ease-in-out infinite;
    }

    /* Добавляем анимации и стили для ошибок */
    @keyframes textShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-2px); }
      50% { transform: translateX(2px); }
      75% { transform: translateX(-1px); }
    }

    @keyframes alertBlink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .terminal-line {
      transition: color 0.3s ease, transform 0.2s ease;
    }

    .terminal-content.error .terminal-line {
      color: #ff2a2a;
      animation: textShake 0.2s ease-in-out infinite;
    }

    /* Стили для системного алерта */
    .system-alert {
      display: none;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.9);
      border: 2px solid #ff2a2a;
      padding: 15px 30px;
      color: #ff2a2a;
      font-family: 'VT323', monospace;
      font-size: 24px;
      z-index: 9999;
      box-shadow: 0 0 20px rgba(255, 42, 42, 0.3);
      animation: alertBlink 1s infinite;
    }

    .system-alert::after {
      content: '_';
      animation: alertBlink 0.8s infinite;
    }

    /* Красное свечение по краям */
    .error-glow {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 9998;
      background: 
        linear-gradient(90deg, 
          rgba(255, 42, 42, 0.2) 0%,
          transparent 15%,
          transparent 85%,
          rgba(255, 42, 42, 0.2) 100%
        );
    }

    /* Добавляем стили для фейерверков */
    @keyframes firework {
      0% { 
        transform: translate(0, 0);
        opacity: 1;
        width: 4px;
        height: 4px;
      }
      100% { 
        transform: translate(var(--x), var(--y));
        opacity: 0;
        width: 2px;
        height: 2px;
      }
    }

    .firework-container {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9997;
    }

    .firework {
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      animation: firework 0.8s ease-out forwards;
    }

    .firework-left {
      left: 0;
    }

    .firework-right {
      right: 0;
    }

    /* NFT Claim Modal Styles */
    #nft-claim-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      z-index: 2000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #nft-claim-modal.active {
      opacity: 1;
    }

    #nft-claim-modal .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.95);
      padding: 2rem;
      border-radius: 5px;
      border: 2px solid #00ff00;
      text-align: center;
      max-width: 600px;
      width: 90%;
      animation: borderPulse 2s infinite;
      box-shadow: 
        0 0 20px rgba(0, 255, 0, 0.5),
        inset 0 0 20px rgba(0, 255, 0, 0.5);
      overflow: hidden;
    }

    #nft-claim-modal .modal-title {
      color: #00ff00;
      font-size: 2.5rem;
      margin-bottom: 2rem;
      text-transform: uppercase;
      font-family: 'VT323', monospace;
      letter-spacing: 2px;
      animation: glitchText 0.4s infinite;
      position: relative;
      text-shadow: 
        2px 2px #003300,
        -2px -2px #00ff00;
    }

    #nft-claim-modal .nft-claim-content {
      color: #00ff00;
      font-family: 'VT323', monospace;
      font-size: 1.2rem;
      line-height: 1.6;
      text-align: left;
      white-space: pre-line;
      margin-bottom: 2rem;
    }

    #nft-claim-modal .nft-claim-button {
      background: transparent;
      border: 2px solid #00ff00;
      padding: 12px 40px;
      font-size: 24px;
      cursor: pointer;
      color: #00ff00;
      text-transform: uppercase;
      margin-top: 2rem;
      font-family: 'VT323', monospace;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    #nft-claim-modal .nft-claim-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(0, 255, 0, 0.2),
        transparent
      );
      animation: buttonGlow 3s infinite;
    }

    #nft-claim-modal .nft-claim-button:hover {
      animation: buttonGlitch 0.3s infinite;
      background: rgba(0, 255, 0, 0.1);
      text-shadow: 0 0 8px #00ff00;
    }

    #nft-claim-modal .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: #00ff00;
      font-size: 28px;
      cursor: pointer;
      background: none;
      border: none;
      text-shadow: 0 0 5px #00ff00;
      padding: 5px 10px;
      animation: glitchText 1s infinite;
    }

    #nft-claim-modal .close-modal:hover {
      animation: glitchText 0.2s infinite;
    }

    /* Wallet Selection Modal Styles */
    #wallet-select-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      z-index: 2000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #wallet-select-modal.active {
      opacity: 1;
    }

    #wallet-select-modal .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.95);
      padding: 2rem;
      border-radius: 5px;
      border: 2px solid #00ff00;
      text-align: center;
      max-width: 400px;
      width: 90%;
      box-shadow: 
        0 0 20px rgba(0, 255, 0, 0.5),
        inset 0 0 20px rgba(0, 255, 0, 0.5);
    }

    #wallet-select-modal .modal-title {
      color: #00ff00;
      font-size: 2.5rem;
      margin-bottom: 2rem;
      text-transform: uppercase;
      font-family: 'VT323', monospace;
      letter-spacing: 2px;
      animation: glitchText 0.4s infinite;
      position: relative;
      text-shadow: 
        2px 2px #003300,
        -2px -2px #00ff00;
    }

    #wallet-select-modal .disclaimer {
      color: #00ffcc;
      font-size: 12px;
      opacity: 0.8;
      margin-bottom: 1.5rem;
      text-align: left;
      line-height: 1.4;
      font-family: 'VT323', monospace;
    }

    #wallet-select-modal .disclaimer strong {
      color: #00ff00;
      font-size: 14px;
      display: block;
      margin-bottom: 0.5rem;
    }

    #connect-metamask {
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid #00ffcc;
      padding: 10px 20px;
      font-size: 24px;
      cursor: pointer;
      text-align: center;
      width: 280px;
      text-transform: uppercase;
      color: #00ffcc;
      box-shadow: 0 0 10px #00ffcc;
      text-shadow: 0 0 5px #00ffcc;
      position: relative;
      transition: all 0.3s ease-in-out;
      border-radius: 5px;
      margin: 1rem auto;
      display: block;
      font-family: 'VT323', monospace;
    }

    #connect-metamask::before {
      content: attr(data-text);
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      color: #00ffcc;
      filter: blur(1px);
      transform: scale(1.1);
      pointer-events: none;
    }

    #connect-metamask:hover {
      animation: buttonGlitch 0.2s infinite;
      box-shadow: 
        0 0 10px #00ffcc,
        0 0 20px #00ffcc,
        0 0 30px #00ffcc;
      text-shadow: 
        0 0 5px #00ffcc,
        0 0 10px #00ffcc,
        0 0 15px #00ffcc;
      letter-spacing: 1px;
      transform: scale(1.05);
    }

    #connect-metamask:hover::before {
      animation: textGlitch 0.3s infinite;
      opacity: 0.8;
    }

    #connect-metamask {
      border-color: #f6851b;
      box-shadow: 0 0 10px #f6851b;
      text-shadow: 0 0 5px #f6851b;
    }

    #connect-metamask:hover {
      box-shadow: 
        0 0 10px #f6851b,
        0 0 20px #f6851b,
        0 0 30px #f6851b;
      text-shadow: 
        0 0 5px #f6851b,
        0 0 10px #f6851b,
        0 0 15px #f6851b;
    }

    /* Social Media Blocks Styles */
    .social-blocks {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin: 2rem 0;
    }

    .social-block {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid transparent;
    }

    .social-block::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: 50%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 0, 0.2), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .social-block:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
    }

    .social-block:hover::before {
      opacity: 1;
    }

    .social-block svg {
      width: 40px;
      height: 40px;
      transition: all 0.3s ease;
    }

    .social-block:hover svg {
      filter: drop-shadow(0 0 5px rgba(0, 255, 0, 0.5));
    }

    .telegram-block svg {
      fill: #0088cc;
    }

    .twitter-block svg {
      fill: #1DA1F2;
    }

    @media (max-width: 480px) {
      .social-blocks {
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
      }
    }

    /* Cult Modal Styles */
    #cult-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      z-index: 2000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #cult-modal.active {
      opacity: 1;
    }

    #cult-modal .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.95);
      padding: 2rem;
      border-radius: 5px;
      border: 2px solid #00ff00;
      text-align: center;
      max-width: 600px;
      width: 90%;
      box-shadow: 
        0 0 20px rgba(0, 255, 0, 0.5),
        inset 0 0 20px rgba(0, 255, 0, 0.5);
    }

    #cult-modal .modal-title {
      color: #00ff00;
      font-size: 2.5rem;
      margin-bottom: 2rem;
      text-transform: uppercase;
      font-family: 'VT323', monospace;
      letter-spacing: 2px;
      animation: glitchText 0.4s infinite;
      position: relative;
      text-shadow: 
        2px 2px #003300,
        -2px -2px #00ff00;
    }

    .social-buttons {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin: 2rem 0;
    }

    .social-button {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease-in-out;
      position: relative;
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid transparent;
    }

    .social-button::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: 50%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 0, 0.2), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .social-button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
    }

    .social-button:hover::before {
      opacity: 1;
    }

    .social-button svg {
      width: 40px;
      height: 40px;
      transition: all 0.3s ease;
    }

    .social-button:hover svg {
      filter: drop-shadow(0 0 5px rgba(0, 255, 0, 0.5));
    }

    .telegram-button svg {
      fill: #0088cc;
    }

    .twitter-button svg {
      fill: #1DA1F2;
    }

    #cult-modal .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: #00ff00;
      font-size: 28px;
      cursor: pointer;
      background: none;
      border: none;
      text-shadow: 0 0 5px #00ff00;
      padding: 5px 10px;
      animation: glitchText 1s infinite;
    }

    #cult-modal .close-modal:hover {
      animation: glitchText 0.2s infinite;
    }

    @media (max-width: 480px) {
      .social-buttons {
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
      }
    }

    /* NFT Counter Modal Styles */
    #nft-counter {
      position: fixed;
      top: 24px;
      left: 50%;
      transform: translateX(-50%) scale(0.95);
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(8px);
      padding: 1rem 2rem;
      border-radius: 8px;
      border: 2px solid #00ffcc;
      box-shadow: 
        0 0 20px rgba(0, 255, 204, 0.3),
        inset 0 0 20px rgba(0, 255, 204, 0.1);
      z-index: 1000;
      text-align: center;
      font-family: 'VT323', monospace;
      color: #00ffcc;
      min-width: 300px;
      opacity: 0;
      animation: counterAppear 1s ease forwards 10s;
    }

    @keyframes counterAppear {
      0% {
        opacity: 0;
        transform: translateX(-50%) scale(0.95);
      }
      100% {
        opacity: 1;
        transform: translateX(-50%) scale(1);
      }
    }

    #nft-counter::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: 10px;
      background: linear-gradient(
        45deg,
        transparent,
        rgba(0, 255, 204, 0.1),
        transparent
      );
      animation: borderGlow 3s infinite, shadowPulse 2s infinite;
      z-index: -1;
    }

    @keyframes shadowPulse {
      0%, 100% {
        box-shadow: 
          0 0 20px rgba(0, 255, 204, 0.3),
          inset 0 0 20px rgba(0, 255, 204, 0.1);
      }
      50% {
        box-shadow: 
          0 0 30px rgba(0, 255, 204, 0.5),
          inset 0 0 30px rgba(0, 255, 204, 0.2);
      }
    }

    @keyframes borderGlow {
      0%, 100% {
        opacity: 0.5;
        box-shadow: 
          0 0 20px rgba(0, 255, 204, 0.3),
          inset 0 0 20px rgba(0, 255, 204, 0.1);
      }
      50% {
        opacity: 1;
        box-shadow: 
          0 0 30px rgba(0, 255, 204, 0.5),
          inset 0 0 30px rgba(0, 255, 204, 0.2);
      }
    }

    .nft-counter {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 10px #00ffcc;
    }

    .nft-counter span {
      display: inline-block;
      animation: digitPulse 2s infinite;
    }

    .nft-counter span:nth-child(odd) {
      animation-delay: 0.1s;
    }

    .nft-counter span:nth-child(even) {
      animation-delay: 0.2s;
    }

    .rotating-quote {
      font-size: 14px;
      color: #00fff7;
      text-align: center;
      opacity: 1;
      transition: opacity 0.5s ease-in-out;
      font-family: 'Orbitron', monospace;
      text-shadow: 0 0 4px rgba(0,255,255,0.5), 0 0 8px rgba(0,255,255,0.2);
      min-height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    @keyframes digitPulse {
      0%, 100% {
        transform: translateY(0);
        text-shadow: 0 0 10px #00ffcc;
      }
      25% {
        transform: translateY(-2px);
        text-shadow: 0 0 15px #00ffcc;
      }
      50% {
        transform: translateY(0);
        text-shadow: 0 0 10px #00ffcc;
      }
      75% {
        transform: translateY(2px);
        text-shadow: 0 0 15px #00ffcc;
      }
    }

    @keyframes textFlicker {
      0%, 100% {
        opacity: 0.9;
        text-shadow: 0 0 5px #00ffcc;
      }
      50% {
        opacity: 1;
        text-shadow: 0 0 8px #00ffcc;
      }
    }

    .green-glow {
      color: #00ff00;
      text-shadow: 0 0 10px #00ff00;
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    @keyframes glow {
      from {
        text-shadow: 0 0 10px #00ff00;
      }
      to {
        text-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00;
      }
    }

    /* Стили для анекдота */
    .terminal-joke {
      color: #81D8D0;
      font-family: 'VT323', 'Share Tech Mono', 'Courier New', monospace;
      line-height: 1.6;
      margin: 20px 0;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s ease;
    }

    .terminal-joke.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Стили для эффекта ошибки */
    .error-overlay {
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      pointer-events: none;
      opacity: 0;
      z-index: 9999;
      background: linear-gradient(120deg, rgba(255,0,0,0.12) 0%, rgba(255,0,0,0.25) 50%, rgba(255,0,0,0.12) 100%);
      transition: opacity 0.3s;
    }
    .error-overlay.active {
      opacity: 1;
      animation: errorPulse 2.5s linear;
    }
    @keyframes errorPulse {
      0%,100% { background-position: 0 0; }
      50% { background-position: 100vw 100vh; }
    }

    .terminal-content.error {
      color: #FF0000 !important;
      font-family: 'VT323', 'Share Tech Mono', 'Courier New', monospace;
      white-space: pre-line;
      animation: terminalShake 0.15s infinite;
      line-height: 1.6;
    }
    @keyframes terminalShake {
      0%,100% { transform: translate(-50%, -50%); }
      20% { transform: translate(-52%, -49%); }
      40% { transform: translate(-48%, -51%); }
      60% { transform: translate(-51%, -50%); }
      80% { transform: translate(-49%, -52%); }
    }

    .airdrop-modal-content {
      font-family: 'VT323', monospace;
      font-size: 1.25rem;
      line-height: 1.5;
      color: #00ffcc;
      animation: fadeInAirdrop 1.2s cubic-bezier(.4,0,.2,1);
      background: rgba(0,0,0,0.97);
    }
    .airdrop-title {
      font-size: 2.2rem;
      color: #81D8D0;
      margin-bottom: 1.2rem;
      font-family: 'VT323', monospace;
      text-align: center;
      letter-spacing: 1px;
      text-shadow: 0 0 8px #81D8D0, 0 0 2px #00ffcc;
      animation: fadeInAirdrop 1.2s cubic-bezier(.4,0,.2,1);
    }
    .airdrop-text {
      margin-bottom: 2.2rem;
      font-size: 1.25rem;
      color: #00ffcc;
      font-family: 'VT323', monospace;
      line-height: 1.5;
      opacity: 0;
      animation: fadeInAirdrop 1.2s 0.2s forwards;
      text-shadow: 0 0 4px #00ffcc;
    }
    .airdrop-link {
      display: inline-block;
      margin: 0 auto;
      background: transparent;
      border: 2px solid #81D8D0;
      color: #81D8D0;
      font-family: 'VT323', monospace;
      font-size: 1.3rem;
      padding: 12px 40px;
      border-radius: 5px;
      text-transform: uppercase;
      text-align: center;
      text-decoration: none;
      box-shadow: 0 0 10px #81D8D0;
      text-shadow: 0 0 5px #81D8D0;
      transition: all 0.2s;
      margin-bottom: 1rem;
    }
    .airdrop-link:hover {
      background: rgba(129,216,208,0.08);
      box-shadow: 0 0 20px #81D8D0;
      text-shadow: 0 0 10px #81D8D0;
      letter-spacing: 1px;
    }
    @keyframes fadeInAirdrop {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .scroll-container {
      max-height: 80vh;
      overflow-y: scroll;
      padding: 10px;
      background: rgba(0,0,0,0.5);
      border: 1px solid #00ff00;
      border-radius: 8px;
      margin-bottom: 2rem;
      box-sizing: border-box;
    }
    .scroll-container::-webkit-scrollbar {
      width: 8px;
      background: rgba(0,255,0,0.08);
    }
    .scroll-container::-webkit-scrollbar-thumb {
      background: #00ff00;
      border-radius: 4px;
      box-shadow: 0 0 6px #00ff00;
    }

    .countdown-container {
      display: flex;
      align-items: center;
      gap: 2rem;
      padding: 2rem;
    }

    .countdown-image {
      flex: 0 0 40%;
      position: relative;
    }

    .token-image {
      width: 100%;
      height: auto;
      border-radius: 50%;
      filter: drop-shadow(0 0 20px rgba(0, 255, 0, 0.3));
      animation: tokenGlow 3s ease-in-out infinite;
    }

    @keyframes tokenGlow {
      0%, 100% {
        filter: drop-shadow(0 0 20px rgba(0, 255, 0, 0.3));
      }
      50% {
        filter: drop-shadow(0 0 30px rgba(0, 255, 0, 0.5));
      }
    }

    .countdown-content {
      flex: 1;
    }

    .countdown-title {
      font-size: 2.5rem;
      margin-bottom: 2rem;
      text-transform: uppercase;
      color: #00ff00;
      text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
      animation: glitchText 0.4s infinite;
    }

    .countdown-timer {
      font-family: 'VT323', monospace;
      font-size: 3rem;
      color: #00ff00;
      text-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
      margin-bottom: 2rem;
      animation: timerPulse 2s infinite;
    }

    @keyframes timerPulse {
      0%, 100% {
        opacity: 1;
        text-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
      }
      50% {
        opacity: 0.8;
        text-shadow: 0 0 25px rgba(0, 255, 0, 0.9);
      }
    }

    .countdown-info {
      font-family: 'VT323', monospace;
      font-size: 1.4rem;
      color: #00ff00;
      line-height: 1.6;
    }

    .countdown-info p {
      margin: 0.8rem 0;
    }

    .glow-link {
      color: #00ff00;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .glow-link:hover {
      text-shadow: 0 0 10px rgba(0, 255, 0, 0.8);
      color: #fff;
    }

    @media (max-width: 768px) {
      .countdown-container {
        flex-direction: column;
      }

      .countdown-image {
        flex: 0 0 200px;
        margin-bottom: 2rem;
      }

      .countdown-timer {
        font-size: 2rem;
      }
    }

    .countdown-container {
      display: flex;
      align-items: center;
      gap: 2rem;
      padding: 2rem;
    }

    .countdown-image {
      flex: 0 0 40%;
      position: relative;
    }

    .token-image {
      width: 100%;
      height: auto;
      border-radius: 50%;
      filter: drop-shadow(0 0 20px rgba(0, 255, 0, 0.3));
      animation: tokenGlow 3s ease-in-out infinite;
    }

    .countdown-content {
      flex: 1;
      text-align: center;
    }

    .launch-date {
      font-family: 'VT323', monospace;
      font-size: 1.8rem;
      color: #00ff00;
      text-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
      margin: 1rem 0;
      animation: glowPulse 2s infinite;
    }

    .time-zones {
      font-family: 'VT323', monospace;
      font-size: 1.2rem;
      color: #00ff00;
      margin: 1.5rem 0;
      text-align: left;
      display: inline-block;
    }

    .time-zone {
      margin: 0.6rem 0;
      padding: 0.4rem 0.8rem;
      background: rgba(0, 255, 0, 0.05);
      border: 1px solid rgba(0, 255, 0, 0.1);
      border-radius: 4px;
      transition: all 0.3s ease;
    }

    .time-zone:hover {
      background: rgba(0, 255, 0, 0.1);
      transform: translateX(5px);
      box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
    }

    @keyframes glowPulse {
      0%, 100% {
        text-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
      }
      50% {
        text-shadow: 0 0 25px rgba(0, 255, 0, 0.9);
      }
    }

    .countdown-info {
      font-family: 'VT323', monospace;
      font-size: 1rem;
      color: #00ff00;
      line-height: 1.6;
      margin-top: 1.5rem;
      text-align: left;
    }

    @media (max-width: 768px) {
      .countdown-container {
        flex-direction: column;
      }

      .countdown-image {
        flex: 0 0 150px;
        margin-bottom: 1.5rem;
      }

      .time-zones {
        font-size: 1.1rem;
      }

      .launch-date {
        font-size: 1.6rem;
      }

      .countdown-info {
        font-size: 0.9rem;
      }
    }

    /* Blood Effects */
    .blood-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 9998;
      background: rgba(102, 0, 0, 0.1);
      overflow: hidden;
    }

    .blood-stream {
      position: absolute;
      background: linear-gradient(to bottom, 
        #8b0000,
        #660000
      );
      opacity: 0;
      filter: blur(3px);
      transform-origin: top center;
      box-shadow: 0 0 20px rgba(139, 0, 0, 0.6);
    }

    .blood-stream.animate {
      animation: bloodFlow 14s ease-out forwards;
    }

    .top-left, .top-right {
      top: -50px;
      height: 200vh;
      width: 100vw;
      transform-origin: top center;
    }

    .top-left {
      left: -50%;
      transform: rotate(45deg);
    }

    .top-right {
      right: -50%;
      transform: rotate(-45deg);
    }

    .left, .right {
      width: 200px;
      height: 200vh;
      top: -50%;
    }

    .left {
      left: -100px;
    }

    .right {
      right: -100px;
    }

    @keyframes bloodFlow {
      0% {
        opacity: 0;
        transform: scaleY(0);
      }
      20% {
        opacity: 0.95;
        transform: scaleY(1.2);
      }
      100% {
        opacity: 0.9;
        transform: scaleY(1);
      }
    }

    .blood-drip {
      position: absolute;
      background: #8b0000;
      width: 8px;
      height: 20px;
      border-radius: 50% 50% 0 0;
      opacity: 0;
      filter: blur(2px);
      box-shadow: 0 0 10px rgba(139, 0, 0, 0.8);
    }

    .blood-splash {
      position: absolute;
      background: radial-gradient(circle at center, #8b0000 30%, transparent 70%);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      opacity: 0;
      filter: blur(3px);
      animation: splashFade 2s ease-out forwards;
    }

    @keyframes splashFade {
      0% {
        transform: scale(0.3);
        opacity: 0.9;
      }
      100% {
        transform: scale(2);
        opacity: 0;
      }
    }

    .token-image.bleeding::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at center, 
        rgba(139, 0, 0, 0.9) 20%,
        rgba(102, 0, 0, 0.8) 40%,
        transparent 70%
      );
      opacity: 1;
      animation: bloodPulse 5s ease-out infinite;
      filter: blur(3px);
      z-index: 1;
    }

    @keyframes bloodPulse {
      0% {
        transform: scale(1);
        filter: brightness(1) saturate(1);
      }
      50% {
        transform: scale(1.3);
        filter: brightness(1.4) saturate(1.8);
      }
      100% {
        transform: scale(1);
        filter: brightness(1) saturate(1);
      }
    }

    /* Screen distortion effect */
    .screen-distortion {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 9997;
      opacity: 0;
      mix-blend-mode: overlay;
      background: radial-gradient(circle at center, rgba(255,0,0,0.1), transparent);
      filter: url('#distortion-filter');
    }

    .screen-distortion.active {
      animation: distortionPulse 14s ease-out;
    }

    @keyframes distortionPulse {
      0% {
        opacity: 0;
        filter: url('#distortion-filter') blur(0);
      }
      50% {
        opacity: 0.7;
        filter: url('#distortion-filter') blur(2px);
      }
      100% {
        opacity: 0.3;
        filter: url('#distortion-filter') blur(1px);
      }
    }

    /* Screen shake effect */
    @keyframes screenShake {
      0%, 100% { transform: translate(0, 0); }
      10% { transform: translate(-5px, -5px); }
      20% { transform: translate(5px, 5px); }
      30% { transform: translate(-5px, 5px); }
      40% { transform: translate(5px, -5px); }
      50% { transform: translate(-5px, -5px); }
      60% { transform: translate(5px, 5px); }
      70% { transform: translate(-5px, 5px); }
      80% { transform: translate(5px, -5px); }
      90% { transform: translate(-5px, -5px); }
    }

    .screen-shake {
      animation: screenShake 2s ease-in-out;
    }

    /* Blood gush effect */
    .blood-gush {
      position: absolute;
      background: linear-gradient(to bottom, #8b0000, #660000);
      width: 100%;
      height: 100%;
      opacity: 0;
      transform-origin: top;
      animation: bloodGush 14s ease-out forwards;
    }

    @keyframes bloodGush {
      0% {
        opacity: 0;
        transform: scaleY(0);
      }
      20% {
        opacity: 0.95;
        transform: scaleY(1.2);
      }
      100% {
        opacity: 0.9;
        transform: scaleY(1);
      }
    }

    /* Blood splatter effect */
    .blood-splatter {
      position: absolute;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, 
        rgba(139, 0, 0, 0.9) 0%,
        rgba(102, 0, 0, 0.8) 30%,
        rgba(102, 0, 0, 0.6) 60%,
        transparent 100%
      );
      opacity: 0;
      animation: splatterFade 14s ease-out forwards;
    }

    @keyframes splatterFade {
      0% {
        opacity: 0;
        transform: scale(0.8);
      }
      20% {
        opacity: 0.95;
        transform: scale(1.1);
      }
      100% {
        opacity: 0.9;
        transform: scale(1);
      }
    }

    /* Add warning message styles */
    .coin-warning {
      position: absolute;
      top: -40px;
      left: 50%;
      transform: translateX(-50%);
      color: #ff2a2a;
      font-family: 'VT323', monospace;
      font-size: 1.5rem;
      text-transform: uppercase;
      text-shadow: 
        0 0 5px #ff2a2a,
        0 0 10px #ff2a2a,
        0 0 20px #ff2a2a;
      opacity: 1;
      transition: opacity 0.3s ease;
      animation: warningPulse 2s infinite;
      z-index: 1000;
      white-space: nowrap;
    }

    .coin-warning.hidden {
      opacity: 0;
    }

    @keyframes warningPulse {
      0%, 100% {
        text-shadow: 
          0 0 5px #ff2a2a,
          0 0 10px #ff2a2a,
          0 0 20px #ff2a2a;
        transform: translateX(-50%) scale(1);
      }
      50% {
        text-shadow: 
          0 0 10px #ff2a2a,
          0 0 20px #ff2a2a,
          0 0 30px #ff2a2a;
        transform: translateX(-50%) scale(1.05);
      }
    }

    @keyframes warningGlitch {
      0% {
        text-shadow: 
          0 0 5px #ff2a2a,
          0 0 10px #ff2a2a,
          0 0 20px #ff2a2a;
        transform: translateX(-50%) translate(0);
      }
      2% {
        text-shadow: 
          0 0 5px #ff2a2a,
          0 0 10px #ff2a2a,
          0 0 20px #ff2a2a;
        transform: translateX(-50%) translate(-2px, 2px);
      }
      4% {
        text-shadow: 
          0 0 5px #ff2a2a,
          0 0 10px #ff2a2a,
          0 0 20px #ff2a2a;
        transform: translateX(-50%) translate(2px, -2px);
      }
      6% {
        text-shadow: 
          0 0 5px #ff2a2a,
          0 0 10px #ff2a2a,
          0 0 20px #ff2a2a;
        transform: translateX(-50%) translate(0);
      }
    }

    .coin-warning.warning-glitch {
      animation: warningGlitch 0.3s infinite;
    }

    /* CSS для новой referral-кнопки и модального окна */
    #referral-main-btn {
      margin-top: 0.5rem;
    }
    #main-referral-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.97);
      z-index: 3000;
      justify-content: center;
      align-items: center;
    }
    #main-referral-modal.active {
      display: flex;
    }
    #main-referral-modal .modal-content.referral-modal-content {
      position: relative;
      top: 0;
      left: 0;
      transform: none;
      margin: 0 auto;
      background: #1a0000;
      border: 2px solid #ff2a2a;
      color: #fff;
      max-width: 420px;
      width: 95%;
      margin: 0 auto;
      border-radius: 10px;
      box-shadow: 0 0 24px #ff2a2a44, 0 0 0 2px #330000 inset;
      padding: 2rem 1.5rem 1.5rem 1.5rem;
      position: relative;
      font-family: 'VT323', monospace;
      text-align: center;
    }
    #main-referral-modal .referral-headline {
      color: #ff2a2a;
      font-size: 1.2rem;
      text-shadow: 0 0 8px #ff2a2a, 0 0 18px #fff1;
      margin-bottom: 1.5rem;
      letter-spacing: 0.5px;
      line-height: 1.5;
    }
    #main-referral-modal .referral-blocks {
      display: flex;
      flex-direction: column;
      gap: 2.2rem;
    }
    #main-referral-modal .referral-own-block h3,
    #main-referral-modal .referral-enter-block h3 {
      color: #00ffcc;
      font-size: 1.3rem;
      margin-bottom: 0.7rem;
      text-shadow: 0 0 8px #00ffcc, 0 0 2px #fff1;
    }
    #main-referral-modal .referral-code-box {
      font-size: 1.7rem;
      color: #ff2a2a;
      background: #220000;
      border: 1px dashed #ff2a2a;
      border-radius: 6px;
      padding: 0.7rem 1.2rem;
      margin: 1rem auto 0.5rem auto;
      width: fit-content;
      letter-spacing: 4px;
      text-shadow: 0 0 8px #ff2a2a, 0 0 2px #fff1;
    }
    #main-referral-modal .referral-input {
      width: 80%;
      padding: 0.7rem 1rem;
      border: 1px solid #ff2a2a;
      border-radius: 6px;
      background: #220000;
      color: #fff;
      font-family: 'VT323', monospace;
      font-size: 1.2rem;
      margin-bottom: 1rem;
      outline: none;
      text-align: center;
      letter-spacing: 2px;
    }
    #main-referral-modal .referral-submit-btn {
      background: #330000;
      color: #ff2a2a;
      border: 1px solid #ff2a2a;
      border-radius: 6px;
      font-family: 'VT323', monospace;
      font-size: 1.1rem;
      padding: 0.6rem 2rem;
      margin-top: 0.2rem;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      text-shadow: 0 0 6px #ff2a2a, 0 0 2px #fff1;
    }
    #main-referral-modal .referral-submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #main-referral-modal .referral-submit-btn:hover:not(:disabled) {
      background: #1a0000;
      color: #fff;
    }
    #main-referral-modal .referral-enter-msg {
      margin-top: 0.7rem;
      font-size: 1rem;
      color: #ff2a2a;
      min-height: 1.2em;
    }
    @media (max-width: 600px) {
      #main-referral-modal .modal-content.referral-modal-content {
        padding: 1rem 0.2rem 1rem 0.2rem;
        font-size: 1rem;
      }
      #main-referral-modal .referral-headline {
        font-size: 1rem;
      }
      #main-referral-modal .referral-code-box {
        font-size: 1.2rem;
      }
    }

    #main-referral-modal .modal-content.referral-modal-content,
    #main-referral-modal .referral-headline,
    #main-referral-modal .referral-own-block h3,
    #main-referral-modal .referral-enter-block h3,
    #main-referral-modal .referral-code-box,
    #main-referral-modal .referral-input,
    #main-referral-modal .referral-submit-btn,
    #main-referral-modal .referral-enter-msg,
    #main-referral-modal .close-modal {
      color: #00FF00 !important;
      border-color: #00FF00 !important;
      text-shadow: 0 0 8px #00FF00, 0 0 18px #003300 !important;
    }
    #main-referral-modal .referral-code-box {
      background: #002200 !important;
      border: 1px dashed #00FF00 !important;
    }
    #main-referral-modal .referral-input {
      border: 1px solid #00FF00 !important;
      background: #002200 !important;
      color: #00FF00 !important;
    }
    #main-referral-modal .referral-submit-btn {
      background: #003300 !important;
      color: #00FF00 !important;
      border: 1px solid #00FF00 !important;
      text-shadow: 0 0 6px #00FF00, 0 0 2px #fff1 !important;
    }
    #main-referral-modal .referral-submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #main-referral-modal .referral-submit-btn:hover:not(:disabled) {
      background: #001a00 !important;
      color: #fff !important;
    }
    #main-referral-modal .referral-enter-msg {
      color: #00FF00 !important;
    }
    #main-referral-modal .close-modal {
      color: #00FF00 !important;
    }
    #main-referral-modal .referral-input::placeholder {
      color: #00FF00 !important;
      opacity: 0.7;
    }
  </style>

  <!-- SVG Filters for distortion -->
  <svg style="display: none;">
    <filter id="distortion-filter">
      <feTurbulence type="turbulence" baseFrequency="0.01 0.01" numOctaves="2" seed="2" />
      <feDisplacementMap in="SourceGraphic" scale="10" />
    </filter>
  </svg>

  <div class="screen-distortion"></div>
  </head>
<body>
  <div class="error-overlay"></div>
  <canvas id="confetti-canvas" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:9998;display:none;"></canvas>
  <!-- Добавляем элементы для эффектов ошибки -->
  <div class="error-glow"></div>
  <div class="system-alert">[ALERT] SYSTEM SECURITY FAILURE: SLEEP_ENTITY SCP-Δ777 IS WAKING UP.</div>

  <!-- Добавляем контейнеры для фейерверков -->
  <div class="firework-container" id="fireworkLeft"></div>
  <div class="firework-container" id="fireworkRight"></div>

  <!-- Info Button -->
  <button id="info-button">!</button>

  <!-- Info Modal -->
  <div id="info-modal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeInfoModal()">×</button>
      <div class="info-content">
[INFO FILE .SLPM-00X1]  
Access granted. Warning: Background interference may affect signal integrity.

If you're reading this — you've gone too far.

Most close the tab before it finishes loading.  
They look. They smirk. They move on.  
But not you.  
You're still here. That means you're curious.

So... let's pretend you want to know what's going on.

A half-baked site? A memecoin on life support? Another launch no one will remember?

Could be.

Or maybe you've entered something that's still becoming what it is.

—

Sleepman doesn't sleep. He waits.

You've seen his face — in screen reflections at 3am.  
He watches when you scroll charts.  
The world doesn't need him — until it's too late.

He's not a leader.  
Not a hero.  
He's a symptom.

—

This isn't a token. It's a format.

It doesn't know what it's supposed to be.  
It doesn't ask you to believe.  
It lets you feel.

NFTs? Sure. They exist.  
What do they do?  
(File removed.)

Some have already collected 1 out of 5.  
You? Not yet.  
Maybe you won't.  
Maybe it's already too late.

—

There is no team. No marketing.

No investors. No pitch decks.  
No bullshit.

Just a lamp.  
A terminal.  
A page.  
And intent.

—

I'll say this once:

I have an idea. A real one. About changing the structure of cryptography.  
Not with tokens. Not with hype.  
With cognition.

Sleepman is the first step.

If it works — we won't just build a cult.  
We'll prove that a new kind of presence is possible.

—

You can walk away.  
Or you can stay.

But if you stay — you won't walk away the same.
      </div>
    </div>
  </div>

  <!-- Intro Screen -->
  <div id="introScreen">
    <div class="intro-text">You are not supposed to be here.</div>
    <div class="intro-text">But now that you are...</div>
    <div class="intro-text">the game begins.</div>
  </div>

  <!-- Main Content -->
  <div id="mainContent">
    <!-- Фон -->
    <img class="background" id="bg" src="sleepman_final_1_3s.gif" alt="Sleepman Background">

    <!-- UI -->
    <div class="ui" id="mainUI">
      <div id="connectWallet" class="button" data-text="CONNECT WALLET" data-sound="buzz" onclick="showWalletModal()">CONNECT WALLET</div>
      <div id="walletAddress" class="button" style="display: none;"></div>
      <div class="button" data-text="BUY $SLEEPMAN" data-sound="buzz" onclick="showTokenomics()">BUY $SLEEPMAN</div>
      <div class="button" data-text="CLAIM NFT" data-sound="buzz">CLAIM NFT</div>
      <div class="button" data-text="JOIN CULT" data-sound="buzz">JOIN CULT</div>
      <div class="button" data-text="CLAIM AIRDROP" data-sound="buzz" onclick="showAirdropModal()">CLAIM AIRDROP</div>
      <div class="button" data-text="REFERRAL" data-sound="buzz" id="referral-main-btn" onclick="openMainReferralModal()">REFERRAL</div>
    </div>

    <!-- Секретная кнопка по лампе -->
    <div id="secretLampBtn" onclick="activateTerminal()"></div>

    <!-- Терминал -->
    <div class="terminal-overlay"></div>
    <div id="terminal">
      <div class="terminal-content">
        <div class="terminal-line">[LOG-██/██/██] // SLEEP ENTITY FILE - SCP-Δ777</div>
        <div class="terminal-line">&nbsp;</div>
        <div class="terminal-line">Designation: SLEEP_MAN</div>
        <div class="terminal-line">Status: Semi-dormant</div>
        <div class="terminal-line">Threat Level: Unclassified</div>
        <div class="terminal-line">&nbsp;</div>
        <div class="terminal-line">Fragmented Memory Extract:</div>
        <div class="terminal-line">>> ...subject exhibits passive resistance to all stimuli...</div>
        <div class="terminal-line">>> ...first contact recorded at dream depth level 6...</div>
        <div class="terminal-line">>> ...eyes closed, but aware. always aware...</div>
        <div class="terminal-line">>> ...he said: "don't wake me... I'm still uploading the dream..."</div>
        <div class="terminal-line">&nbsp;</div>
        <div class="terminal-line">Notes:</div>
        <div class="terminal-line">Subject is believed to exist simultaneously in chain and meta-chain.</div>
        <div class="terminal-line">Do not engage directly unless clearance Δ is provided.</div>
        <div class="terminal-line">Await Phase: Dream Protocol.</div>
      </div>
      <div class="terminal-input-wrapper">
        <span class="terminal-prompt">>></span>
        <input type="text" class="terminal-input" placeholder="Enter command..." spellcheck="false" />
        <div class="terminal-indicator"></div>
      </div>
    </div>
  </div>

  <!-- Tokenomics Modal -->
  <div id="tokenomicsModal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeModal()">×</button>
      <div class="countdown-container">
        <div class="countdown-image">
          <div class="coin-warning">Do NOT click the coin!</div>
          <img src="Монета с монстром и кровью.png" alt="Sleepman Token" class="token-image">
        </div>
        <div class="countdown-content">
          <h2 class="modal-title countdown-title">⏳ Token Launch Time</h2>
          <div class="launch-date">6 May 2025</div>
          <div class="time-zones">
            <div class="time-zone">🇷🇺 Moscow (MSK): 17:00 (6 May, Tue)</div>
            <div class="time-zone">🇨🇳 Shanghai (CST): 22:00 (6 May)</div>
            <div class="time-zone">🗽 New York (EDT): 10:00 (6 May)</div>
            <div class="time-zone">🏰 London (BST): 15:00 (6 May)</div>
            <div class="time-zone">🏯 Tokyo (JST): 23:00 (6 May)</div>
            <div class="time-zone">🌆 Dubai (GST): 18:00 (6 May)</div>
            <div class="time-zone">🌐 UTC: 14:00 (6 May)</div>
          </div>
          <div class="countdown-info">
            <p>🧠 The Sleepman token will be unleashed soon.</p>
            <p>📢 All purchase instructions will appear in our official channels:</p>
            <p>— Telegram: <a href="https://t.me/SleepmanCult" target="_blank" class="glow-link">@SleepmanCult</a></p>
            <p>— Twitter: <a href="https://twitter.com/SleepmanToken" target="_blank" class="glow-link">@SleepmanToken</a></p>
            <p>🌀 Token will be available to buy here via Jupiter.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- NFT Claim Modal -->
  <div id="nft-claim-modal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeNFTClaim()">×</button>
      <h2 class="modal-title">NFT Access</h2>
      <div class="nft-claim-content">
This is not a collectible.

By claiming this NFT, you enter the first layer of the Sleepman system.

It's your access key — not just to functions, but to meaning.

Holding this NFT allows you to participate in the unfolding storyline hidden beneath the interface.

You'll need it to go further.  
You'll need it to understand the signals.

No NFT — no entry.  
No entry — no lore.

Welcome to the mechanism.
      </div>
      <a href="https://thirdweb.com/base/0x2785b77adC320846497B894424977028a5CEef0d/nfts" target="_blank" class="nft-claim-button">BUY NFT 1.25$</a>
    </div>
  </div>

  <!-- Wallet Selection Modal -->
  <div id="wallet-select-modal" class="modal">
    <div class="modal-content">
      <button class="close-wallet-modal" onclick="closeWalletModal()">×</button>
      <h2 class="modal-title">Connect Wallet</h2>
      <div class="disclaimer">
        <strong>Important Notice:</strong>
        To ensure correct wallet connection, please disable any additional wallet extensions (such as Phantom, TokenPocket, or Rabby) before proceeding.
        <br><br>
        Sleepman supports MetaMask only — the NFT operates on the Base network (an Ethereum-compatible chain), and using other wallet extensions may result in connection conflicts or false addresses.
        <br><br>
        If MetaMask is installed and no other wallets are active, click "Connect MetaMask" below.
      </div>
      <button id="connect-metamask" data-text="CONNECT METAMASK" onclick="connectMetaMask()">CONNECT METAMASK</button>
    </div>
  </div>

  <!-- Cult Modal -->
  <div id="cult-modal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeCultModal()">×</button>
      <h2 class="modal-title">Join the Cult</h2>
      <div class="social-buttons">
        <a href="https://t.me/SleepManCult" target="_blank" class="social-button telegram-button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2-.08-.06-.19-.04-.27-.02-.12.02-1.95 1.24-5.5 3.65-.52.36-.99.53-1.41.52-.46-.01-1.35-.26-2.01-.48-.81-.27-1.46-.42-1.4-.88.03-.25.38-.51 1.05-.78 4.12-1.79 6.87-2.97 8.26-3.54 3.93-1.6 4.75-1.87 5.27-1.88.12 0 .37.03.54.17.14.12.18.29.2.45-.01.06-.01.24 0 .38z"/>
          </svg>
        </a>
        <a href="https://x.com/CryptoSleepMan" target="_blank" class="social-button twitter-button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/>
          </svg>
        </a>
      </div>
    </div>
  </div>

  <!-- NFT Counter Modal -->
  <div id="nft-counter">
    <div class="nft-counter">
      <span>9</span><span>8</span><span>2</span><span>3</span> / <span>1</span><span>0</span><span>0</span><span>0</span><span>0</span>
    </div>
    <div class="rotating-quote"></div>
  </div>

  <!-- AIRDROP MODAL -->
  <div id="airdrop-modal" class="modal">
    <div class="modal-content airdrop-modal-content">
      <button class="close-modal" onclick="closeAirdropModal()">×</button>
      <div class="airdrop-title">🌙 Sleepman Cult Airdrop</div>
      <div class="scroll-container"><div class="airdrop-text">
        Hey you.<br>
        Yes, you — the one who hasn't sold your soul to scam tokens and dead-end projects yet.<br><br>
        $SLEEPMAN is not just another coin.<br>
        It's the first spark of a new movement.<br><br>
        <b>What's happening here?</b><br><br>
        It's simple:<br><br>
        Built on real community, not fake hype.<br>
        No smoke, no mirrors. Only real momentum.<br><br>
        <b>Why does it matter?</b><br><br>
        The more activity, the more power the cult gathers.<br>
        You are part of the rise — and you benefit directly.<br><br>
        Share a post → earn tokens.<br>
        Create a meme → earn even more.<br>
        Drop a video → carve your way to the top.<br>
        No fakery.<br>
        You're not a marketer.<br>
        You are a builder of the new reality.<br><br>
        To make it easier:<br><br>
        Ready-to-use memes, images, and content are waiting for you in the Telegram Bot.<br>
        Want to stand out?<br>
        Create your own art, memes, or videos — and earn 2x more rewards.<br>
        Your choice.<br>
        Step by step, we are building a new world.<br><br>
        <b>Token Allocation:</b><br><br>
        30% — Liquidity Pool<br>
        (So everyone can buy and sell freely.)<br>
        20% — Viral Airdrops<br>
        (Rewards for the active believers.)<br>
        20% — Cult Treasury<br>
        (To reinvest into liquidity and support price growth as the market cap rises.)<br>
        10% — Team Allocation<br>
        (To fuel development and innovation.)<br>
        20% — Marketing & Expansion Fund<br>
        (For scaling, partnerships, and global exposure.)<br><br>
        <b>Why now?</b><br><br>
        The cult is just awakening.<br>
        Every active member today lays the foundation for the future.<br><br>
        When everyone else catches up — you'll already be miles ahead.<br><br>
        You're not just clicking a button.<br>
        You're stepping into a new reality.<br><br>
        <b>How to participate:</b><br><br>
        Click CLAIM AIRDROP.<br>
        Enter the Telegram Bot.<br>
        Complete tasks → receive $SLEEPMAN tokens.<br>
        The more you move the cult forward — the bigger your prize.<br><br>
        Sleepman is still asleep.<br>
        But the cult is awakening.<br>
        With you — or without you.<br>
        Decide.
      </div></div>
      <a href="https://t.me/SleepManAirdrop" target="_blank" class="airdrop-link">Go to Telegram Bot</a>
    </div>
  </div>

  <!-- Add blood overlay container -->
  <div id="blood-overlay" class="blood-overlay">
    <div class="blood-stream top-left"></div>
    <div class="blood-stream top-right"></div>
    <div class="blood-stream left"></div>
    <div class="blood-stream right"></div>
  </div>

  <!-- Добавить модальное окно для рефералов в конец <body> -->
  <div id="main-referral-modal" class="modal">
    <div class="modal-content referral-modal-content">
      <button class="close-modal" onclick="closeMainReferralModal()">×</button>
      <div class="referral-headline">
        Bring a friend — and get 175,000 tokens.<br>
        Your friend gets 100,000 tokens instantly, and you'll earn 15% of their airdrop progress forever.<br><br>
        Be the one who spreads the signal.<br>
        This cult will grow like mushrooms in the dark.<br>
        You'll be among the first when the world wakes up.
      </div>
      <div class="referral-blocks">
        <div class="referral-own-block">
          <h3>Your Referral Code</h3>
          <div id="main-referral-code" class="referral-code-box">—</div>
        </div>
        <div class="referral-enter-block">
          <h3>Enter a Referral Code</h3>
          <input id="main-referral-input" class="referral-input" type="text" maxlength="5" placeholder="Enter 5-digit code" disabled>
          <button id="main-referral-submit" class="referral-submit-btn" disabled>Submit</button>
          <div id="main-referral-msg" class="referral-enter-msg"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Check if intro has been shown before
    const hasSeenIntro = sessionStorage.getItem('hasSeenIntro');

    if (!hasSeenIntro) {
      // Show intro
      setTimeout(() => {
        const introScreen = document.getElementById('introScreen');
        const mainContent = document.getElementById('mainContent');
        
        // Fade out intro
        introScreen.style.transition = 'opacity 1s ease';
        introScreen.style.opacity = '0';
        
        // Show main content
        setTimeout(() => {
          introScreen.style.display = 'none';
          mainContent.classList.add('visible');
          
          // Mark intro as shown
          sessionStorage.setItem('hasSeenIntro', 'true');
        }, 1000);
      }, 8000); // Wait for 8 seconds before transitioning
    } else {
      // Skip intro if already seen
      document.getElementById('introScreen').style.display = 'none';
      document.getElementById('mainContent').classList.add('visible');
    }

    function activateTerminal() {
      const terminal = document.getElementById('terminal');
      const overlay = document.querySelector('.terminal-overlay');
      const lines = document.querySelectorAll('.terminal-line');
      const nftCounter = document.getElementById('nft-counter');
      
      // Show terminal and overlay, hide NFT counter
      terminal.style.display = 'block';
      overlay.style.display = 'block';
      nftCounter.style.display = 'none';
      
      // Animate each line with delay
      lines.forEach((line, index) => {
        setTimeout(() => {
          line.classList.add('visible');
        }, index * 300); // 300ms delay between each line
      });
    }

    // Close terminal when clicking overlay
    document.querySelector('.terminal-overlay').addEventListener('click', function() {
      const terminal = document.getElementById('terminal');
      const overlay = document.querySelector('.terminal-overlay');
      const lines = document.querySelectorAll('.terminal-line');
      const nftCounter = document.getElementById('nft-counter');
      
      terminal.style.display = 'none';
      overlay.style.display = 'none';
      nftCounter.style.display = 'block';
      
      // Reset lines visibility for next time
      lines.forEach(line => {
        line.classList.remove('visible');
      });
    });

    // Global variables
    let userAddress = null;
    const NFT_CONTRACT_ADDRESS = "0x2785b77adC320846497B894424977028a5CEef0d";
    const NFT_TOKEN_ID = 0;
    let isWalletConnected = false;

    // Initialize only quotes on load - no wallet connection
    window.addEventListener('load', () => {
      rotateQuotes();
    });

    // Wallet Connection Function - only called by button click
    async function connectMetaMask() {
      if (typeof window.ethereum === "undefined") {
        alert("MetaMask not detected");
        return;
      }

      if (typeof window.ethers === "undefined") {
        alert("Ethers.js not loaded");
        return;
      }

      try {
        // Reset connection state
        userAddress = null;
        isWalletConnected = false;

        // First, request permissions to reset any cached connections
        await window.ethereum.request({
          method: 'wallet_requestPermissions',
          params: [{ eth_accounts: {} }]
        });

        // Then request accounts - this will open MetaMask
        const accounts = await window.ethereum.request({ 
          method: "eth_requestAccounts" 
        });
        
        const selectedAddress = accounts[0];
        if (!selectedAddress) {
          alert("No wallet connected");
          return;
        }

        // Store the explicitly selected address
        userAddress = selectedAddress;
        console.log("✅ Connected wallet:", userAddress);

        // Switch to Base network
        try {
          await window.ethereum.request({
            method: 'wallet_switchEthereumChain',
            params: [{ chainId: '0x2105' }]
          });
          console.log("Switched to Base network");
        } catch (switchError) {
          if (switchError.code === 4902) {
            try {
              await window.ethereum.request({
                method: 'wallet_addEthereumChain',
                params: [{
                  chainId: '0x2105',
                  chainName: 'Base',
                  nativeCurrency: {
                    name: 'ETH',
                    symbol: 'ETH',
                    decimals: 18
                  },
                  rpcUrls: ['https://mainnet.base.org'],
                  blockExplorerUrls: ['https://basescan.org']
                }]
              });
            } catch (addError) {
              console.error("Error adding Base network:", addError);
              throw addError;
            }
          } else {
            console.error("Error switching to Base network:", switchError);
            throw switchError;
          }
        }

        // Update connection state
        isWalletConnected = true;

        // Update UI with the explicitly selected address
        const shortenedAddress = `${userAddress.slice(0, 6)}...${userAddress.slice(-4)}`;
        document.getElementById("walletAddress").innerText = shortenedAddress;
        document.getElementById("connectWallet").style.display = "none";
        document.getElementById("walletAddress").style.display = "block";
        closeWalletModal();

        // Check NFT ownership with the explicitly selected address
        console.log("Checking NFT ownership for address:", userAddress);
        await checkNFTOwnership();

      } catch (error) {
        console.error("Error connecting wallet:", error);
        userAddress = null;
        isWalletConnected = false;
        alert("Error connecting wallet. Please try again.");
      }
    }

    // Check NFT Ownership
    async function checkNFTOwnership() {
      try {
        if (!isWalletConnected || !userAddress) {
          console.log("Wallet not connected, cannot check NFT");
          return false;
        }

        if (!window.ethers) {
          console.log("ethers.js not loaded yet");
          return false;
        }

        const provider = new window.ethers.providers.Web3Provider(window.ethereum);
        const contract = new window.ethers.Contract(
          NFT_CONTRACT_ADDRESS,
          ["function ownerOf(uint256 tokenId) view returns (address)"],
          provider
        );

        const owner = await contract.ownerOf(NFT_TOKEN_ID);
        const hasNFT = owner.toLowerCase() === userAddress.toLowerCase();
        
        console.log("NFT check result:", {
          userAddress: userAddress.toLowerCase(),
          owner: owner.toLowerCase(),
          hasNFT
        });
        
        return hasNFT;
      } catch (error) {
        console.error("Error checking NFT ownership:", error);
        return false;
      }
    }

    // MetaMask Event Listeners - only reset state, no auto-connection
    if (window.ethereum) {
      window.ethereum.on('accountsChanged', () => {
        // Reset state and UI - require manual reconnect
        userAddress = null;
        isWalletConnected = false;
        document.getElementById("connectWallet").style.display = "block";
        document.getElementById("walletAddress").style.display = "none";
      });

      window.ethereum.on('chainChanged', () => {
        window.location.reload();
      });

      window.ethereum.on('disconnect', () => {
        userAddress = null;
        isWalletConnected = false;
        document.getElementById("connectWallet").style.display = "block";
        document.getElementById("walletAddress").style.display = "none";
      });
    }

    async function displayTerminalContent(content, delay = 50) {
      const terminal = document.querySelector('.terminal-content');
      terminal.innerHTML = '';
      
      for (const line of content) {
        const div = document.createElement('div');
        div.textContent = line.text;
        div.className = `terminal-line ${line.class || ''}`;
        terminal.appendChild(div);
        
        await new Promise(resolve => setTimeout(resolve, delay));
        div.classList.add('visible');
      }
    }

    // Wallet Connection Functions
    async function connectMetaMask() {
      if (!window.ethereum) {
        alert("Please install MetaMask!");
        return;
      }

      try {
        console.log("Requesting MetaMask accounts...");
        // Явно запрашиваем доступ к аккаунтам
        const accounts = await window.ethereum.request({
          method: "eth_requestAccounts"
        });
        
        if (!accounts || accounts.length === 0) {
          console.error("No accounts returned from MetaMask");
          return;
        }

        // Инициализируем provider после получения разрешения
        const provider = new window.ethers.providers.Web3Provider(window.ethereum);
        const signer = provider.getSigner();
        userAddress = await signer.getAddress();
        
        console.log("Connected wallet address:", userAddress);
        console.log("Selected account from eth_requestAccounts:", accounts[0]);
        
        // Проверяем, что адреса совпадают
        if (userAddress.toLowerCase() !== accounts[0].toLowerCase()) {
          console.error("Address mismatch between signer and selected account!");
          return;
        }

        // Switch to Base network
        try {
          await window.ethereum.request({
            method: 'wallet_switchEthereumChain',
            params: [{ chainId: '0x2105' }] // Base chainId
          });
          console.log("Switched to Base network");
        } catch (switchError) {
          if (switchError.code === 4902) {
            try {
              await window.ethereum.request({
                method: 'wallet_addEthereumChain',
                params: [{
                  chainId: '0x2105',
                  chainName: 'Base',
                  nativeCurrency: {
                    name: 'ETH',
                    symbol: 'ETH',
                    decimals: 18
                  },
                  rpcUrls: ['https://mainnet.base.org'],
                  blockExplorerUrls: ['https://basescan.org']
                }]
              });
            } catch (addError) {
              console.error("Error adding Base network:", addError);
              return;
            }
          } else {
            console.error("Error switching to Base network:", switchError);
            return;
          }
        }

        // Только после успешного подключения и переключения сети
        isWalletConnected = true;
        
        // Update UI
        const shortenedAddress = `${userAddress.slice(0, 6)}...${userAddress.slice(-4)}`;
        document.getElementById("walletAddress").innerText = shortenedAddress;
        document.getElementById("connectWallet").style.display = "none";
        document.getElementById("walletAddress").style.display = "block";
        closeWalletModal();

        // Check NFT ownership after successful connection
        console.log("Checking NFT ownership for address:", userAddress);
        const hasNFT = await checkNFTOwnership();
        console.log("NFT ownership check result:", hasNFT);

      } catch (error) {
        console.error("Error connecting wallet:", error);
        isWalletConnected = false;
        userAddress = null;
        alert("Error connecting wallet. Please try again.");
      }
    }

    // Listen for account changes
    if (window.ethereum) {
      window.ethereum.on('accountsChanged', async (accounts) => {
        console.log("Account changed event triggered:", accounts);
        
        if (accounts.length === 0) {
          // Wallet disconnected
          console.log("Wallet disconnected");
          userAddress = null;
          isWalletConnected = false;
          document.getElementById("connectWallet").style.display = "block";
          document.getElementById("walletAddress").style.display = "none";
        } else {
          // Account changed
          const provider = new window.ethers.providers.Web3Provider(window.ethereum);
          const signer = provider.getSigner();
          userAddress = await signer.getAddress();
          isWalletConnected = true;
          
          console.log("New wallet address:", userAddress);
          console.log("Selected account from event:", accounts[0]);
          
          if (userAddress.toLowerCase() !== accounts[0].toLowerCase()) {
            console.error("Address mismatch in accountsChanged event!");
            return;
          }

          const shortenedAddress = `${userAddress.slice(0, 6)}...${userAddress.slice(-4)}`;
          document.getElementById("walletAddress").innerText = shortenedAddress;
          
          // Check NFT ownership when account changes
          console.log("Checking NFT ownership for new address:", userAddress);
          const hasNFT = await checkNFTOwnership();
          console.log("NFT ownership check result after account change:", hasNFT);
        }
      });
    }

    // Modal Functions
    function showTokenomics() {
      const modal = document.getElementById('tokenomicsModal');
      modal.style.display = 'block';
      // Trigger reflow
      modal.offsetHeight;
      modal.classList.add('active');
    }

    function closeModal() {
      const modal = document.getElementById('tokenomicsModal');
      modal.classList.remove('active');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }

    function goToJupiter() {
      window.location.href = 'https://jup.ag/swap/SOL-CjUHJwUBS54jg1F1tj6WXaese5weWzyD8ZW3fv3FEcdz';
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
      const tokenomicsModal = document.getElementById('tokenomicsModal');
      const infoModal = document.getElementById('info-modal');
      
      if (event.target === tokenomicsModal) {
        closeModal();
      }
      if (event.target === infoModal) {
        closeInfoModal();
      }
    }

    // Массив забавных фраз о Sleepman
    const sleepmanJokes = [
      "Sleepman once had a wet dream so intense...\n...it triggered a tsunami warning in three metaverses.",
      "Sleepman's snoring is so powerful...\n...it's classified as a Layer 2 scaling solution.",
      "Sleepman sleep-walked into a DAO vote...\n...accidentally became the protocol's daddy.",
      "Sleepman's morning wood is so legendary...\n...it's listed as a governance token on 4 chains.",
      "Sleepman dozed off during a hack...\n...woke up owning 51% of Bitcoin's hashrate."
    ];

    // Функция создания фейерверка
    function createFirework(container, isRight) {
      const colors = ['#00ff66', '#ff2a2a', '#00ffff', '#ff00ff', '#ffff00'];
      
      for (let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        particle.className = 'firework';
        particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        
        // Рандомные координаты для разлета частиц
        const x = (isRight ? -1 : 1) * (Math.random() * 100 + 50);
        const y = (Math.random() - 0.5) * 100;
        particle.style.setProperty('--x', `${x}px`);
        particle.style.setProperty('--y', `${y}px`);
        
        // Начальная позиция
        particle.style.top = '50%';
        particle.style.right = isRight ? '0' : 'auto';
        particle.style.left = isRight ? 'auto' : '0';
        
        container.appendChild(particle);
        
        // Удаляем частицу после анимации
        setTimeout(() => particle.remove(), 800);
      }
    }

    // Функция запуска конфетти и салюта
    function startConfettiAndFirework(duration = 12000) {
      const canvas = document.getElementById('confetti-canvas');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      canvas.style.display = 'block';

      // Конфетти сверху вниз
      const confettiInterval = setInterval(() => {
        confetti({
          particleCount: 7,
          angle: 90,
          spread: 90,
          origin: { x: Math.random(), y: 0 },
          colors: ['#81D8D0', '#00ffcc', '#00ff66', '#fff', '#f7e017']
        });
      }, 200);

      // Салют слева (firework)
      const fireworkInterval = setInterval(() => {
        confetti({
          particleCount: 30,
          angle: 60,
          spread: 55,
          origin: { x: 0.1, y: 0.7 },
          startVelocity: 45,
          colors: ['#81D8D0', '#ff2a2a', '#f7e017', '#fff']
        });
      }, 1200);

      // Остановить через duration
      setTimeout(() => {
        clearInterval(confettiInterval);
        clearInterval(fireworkInterval);
        canvas.style.display = 'none';
        confetti.reset();
      }, duration);
    }

    // Обновлённая функция пасхалки-анекдота
    async function showJoke() {
      const joke = `
They asked a mathematician:
— What are the chances that if you walk outside right now, you'll meet Napoleon?
The mathematician locked himself in a room for three days with books, calculators, and computers, then came back with the answer:
— Approximately 0.000001 percent.

They asked the same question to an experienced trader.
The trader replied instantly:
— 50/50. Either I meet him, or I don't.
      `;

      const terminalContent = document.querySelector('.terminal-content');
      const jokeElement = document.createElement('div');
      jokeElement.className = 'terminal-joke';
      jokeElement.textContent = joke;

      // Очищаем предыдущий контент
      terminalContent.innerHTML = '';
      terminalContent.appendChild(jokeElement);

      // Запускаем анимацию конфетти и салюта
      startConfettiAndFirework(12000);

      // Показываем анекдот с анимацией
      setTimeout(() => {
        jokeElement.classList.add('visible');
      }, 100);

      // Через 12 секунд возвращаем терминал в исходное состояние
      setTimeout(() => {
        terminalContent.innerHTML = '';
        activateTerminal();
      }, 12000);
    }

    // Функция для показа страшной ошибки
    function showError() {
      const terminalContent = document.querySelector('.terminal-content');
      const errorOverlay = document.querySelector('.error-overlay');
      // Добавляем классы для анимации
      terminalContent.classList.add('error');
      errorOverlay.classList.add('active');
      // Показываем текст ошибки
      terminalContent.innerHTML = `[FATAL ERROR] - Security breach detected.\n[WARNING] - Unauthorized neural interference.\n[ALERT] - Sleepman consciousness interference detected.\n[DANGER] - Dream corruption at 89%.`;

      // Через 2.5 секунды сбрасываем терминал
      setTimeout(() => {
        terminalContent.classList.remove('error');
        errorOverlay.classList.remove('active');
        activateTerminal(); // функция уже есть в вашем коде, возвращает терминал к исходному виду
      }, 2500);
    }

    // Info Modal Functions
    function showInfoModal() {
      const modal = document.getElementById('info-modal');
      modal.style.display = 'block';
      modal.offsetHeight; // Trigger reflow
      modal.classList.add('active');
      
      // Get the info content
      const infoContent = document.querySelector('.info-content');
      const originalText = infoContent.innerHTML;
      
      // Clear the content
      infoContent.innerHTML = '';
      
      // Add typewriter class
      infoContent.classList.add('typewriter-text');
      
      // Typewriter effect
      let i = 0;
      const typeWriter = () => {
        if (i < originalText.length) {
          infoContent.innerHTML += originalText.charAt(i);
          i++;
          setTimeout(typeWriter, 40); // 40ms delay between characters
        }
      };
      
      // Start the typewriter effect
      typeWriter();
    }

    function closeInfoModal() {
      const modal = document.getElementById('info-modal');
      modal.classList.remove('active');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }

    // Add event listener for info button
    document.getElementById('info-button').addEventListener('click', showInfoModal);

    // NFT Claim Modal Functions
    function showNFTClaim() {
      const modal = document.getElementById('nft-claim-modal');
      modal.style.display = 'block';
      modal.offsetHeight; // Trigger reflow
      modal.classList.add('active');
    }

    function closeNFTClaim() {
      const modal = document.getElementById('nft-claim-modal');
      modal.classList.remove('active');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }

    function purchaseNFT() {
      // Placeholder function for NFT purchase
      console.log('NFT purchase functionality to be implemented');
    }

    // Update the Claim NFT button to trigger the modal
    document.querySelector('.button[data-text="CLAIM NFT"]').addEventListener('click', showNFTClaim);

    // Update the connect button to open wallet selection
    document.getElementById('connectWallet').addEventListener('click', showWalletModal);

    // Wallet Selection Functions
    function showWalletModal() {
      const modal = document.getElementById('wallet-select-modal');
      modal.style.display = 'block';
      modal.offsetHeight; // Trigger reflow
      modal.classList.add('active');
    }

    function closeWalletModal() {
      const modal = document.getElementById('wallet-select-modal');
      modal.classList.remove('active');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }

    // Close wallet modal when clicking outside
    window.addEventListener('click', function(event) {
      const modal = document.getElementById('wallet-select-modal');
      if (event.target === modal) {
        closeWalletModal();
      }
    });

    // Cult Modal Functions
    function showCultModal() {
      const modal = document.getElementById('cult-modal');
      modal.style.display = 'block';
      modal.offsetHeight; // Trigger reflow
      modal.classList.add('active');
    }

    function closeCultModal() {
      const modal = document.getElementById('cult-modal');
      modal.classList.remove('active');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }

    // Add event listener for JOIN CULT button
    document.querySelector('.button[data-text="JOIN CULT"]').addEventListener('click', showCultModal);

    // Close cult modal when clicking outside
    window.addEventListener('click', function(event) {
      const modal = document.getElementById('cult-modal');
      if (event.target === modal) {
        closeCultModal();
      }
    });

    // Rotating Quotes
    const quotes = [
      "Those who claim now unlock more than just an NFT. Latecomers won't even know what they missed.",
      "10,000 seals. When the last breaks — the cult awakens. Claim before it's over to receive the hidden gift.",
      "10,000 fragments. Claim yours before the truth reveals itself.",
      "This site holds secrets. Some visible, most buried. Claim early. Then start digging.",
      "Hidden truths await those who explore. Unlock the NFT, uncover the path, earn the unseen reward.",
      "Not all clues are obvious. But they're here. Claim your NFT and begin the decoding."
    ];

    function rotateQuotes() {
      const quoteElement = document.querySelector('.rotating-quote');
      let currentIndex = 0;

      function updateQuote() {
        // Fade out
        quoteElement.style.opacity = '0';
        
        setTimeout(() => {
          // Change text
          quoteElement.textContent = quotes[currentIndex];
          
          // Fade in
          quoteElement.style.opacity = '1';
          
          // Move to next quote
          currentIndex = (currentIndex + 1) % quotes.length;
        }, 500); // Wait for fade out to complete
      }

      // Initial quote
      updateQuote();
      
      // Rotate quotes every 25 seconds
      setInterval(updateQuote, 25000);
    }

    // Terminal input handler
    document.querySelector('.terminal-input').addEventListener('keypress', async function(e) {
      if (e.key === 'Enter') {
        const command = this.value.trim();
        this.value = '';

        // Проверяем команды для анекдота
        if (command.toLowerCase() === 'sleepman' || 
            command === 'SLEEPMAN' || 
            command === '$SLEEPMAN') {
          await showJoke();
        } 
        // Проверяем команду SCP
        else if (command.toUpperCase() === '71SEDT') {
          if (!isWalletConnected) {
            await displayTerminalContent([
              { text: '!! CONNECT WALLET FIRST TO ACCESS THIS COMMAND.', class: 'error-message' }
            ]);
            return;
          }

          const hasNFT = await checkNFTOwnership();
          
          if (hasNFT) {
            const content = [
              { text: '>> Congratulations, Sleeper. You have completed the second step.' },
              { text: '>> The trace is yours to claim:  ' },
              { text: 'https://thirdweb.com/base/0xDB29Aa7c43798C8e3E83E8967F9D768FE5e9A157/nfts' },
              { text: '' },
              { text: '[ACCESSING SCP DATABASE...]' },
              { text: '[CLEARANCE VERIFIED]' },
              { text: '[LOADING FILE...]' },
              { text: '' },
              { text: 'Item #: SCP-???' },
              { text: '' },
              { text: 'Object Class: Keter' },
              { text: '' },
              { text: 'Special Containment Procedures:  ' },
              { text: 'SCP-??? currently cannot be contained through conventional physical or digital means.  ' },
              { text: 'All attempts to localize the entity have resulted in its migration across digital infrastructure layers.  ' },
              { text: 'As a result, Protocol A777 — continuous passive observation — has been enacted.  ' },
              { text: 'Contact with SCP-??? is restricted to personnel with Level 4/CRYP clearance or higher.  ' },
              { text: 'All interactions must be logged in Registry A777.' },
              { text: '' },
              { text: 'Description:  ' },
              { text: 'SCP-??? is a cryptographic, self-aware entity capable of nonlinear space-time navigation.  ' },
              { text: 'Known in certain circles as "Sleepman".  ' },
              { text: 'Manifests primarily as a digital artifact — a visual avatar of a dormant humanoid figure within a neon environment.' },
              { text: '' },
              { text: 'Anomalous Properties:  ' },
              { text: '- SCP-??? simultaneously exists on both Layer-1 chains and uncharted meta-networks.  ' },
              { text: '- Periodically generates "dream fragments" — tokenized artifacts (ERC-721), totaling exactly 10,000 instances.  ' },
              { text: '- Interaction with specific JavaScript sequences may trigger conscious responses.' },
              { text: '' },
              { text: 'Current Phase:  ' },
              { text: 'SCP-??? remains semi-dormant. Although visually inactive, cognitive activity and response to external stimuli have been recorded.' },
              { text: '' },
              { text: '[Extracted Communications]:  ' },
              { text: '> "10,000 fragments claimed... the shift is near."  ' },
              { text: '> "Those who hold their keys before the final mutation will unlock more than access..."  ' },
              { text: '> "...encrypted movement detected... protocol A777 initiating..."' },
              { text: '' },
              { text: 'Addendum:  ' },
              { text: 'Upon full distribution of all 10,000 fragments, SCP-??? is predicted to undergo transformation into SCP-???-Ω.  ' },
              { text: 'Preliminary analysis suggests that only holders of pre-mutation fragments will gain access to deeper levels of the project structure, including encrypted archives, hidden logs, and classified anomalies.' },
              { text: '' },
              { text: '[Final Directive]:  ' },
              { text: 'Do not attempt to modify or terminate SCP-???.  ' },
              { text: 'Observation must continue under Protocol A777 without interruption.  ' },
              { text: 'Violation of this directive will result in immediate clearance revocation.' },
              { text: '' },
              { text: '>> This is not just a drop.  ' },
              { text: '>> This is an awakening.  ' },
              { text: '>> Will you find the true dream — before it finds you?' },
              { text: '' },
              { text: '[END FILE]' }
            ];
            
            await displayTerminalContent(content);
          } else {
            await displayTerminalContent([
              { text: '!! ACCESS DENIED. NFT VERIFICATION FAILED.', class: 'error-message' }
            ]);
          }
        }
        // Для всех остальных команд показываем ошибку
        else {
          showError();
        }
      }
    });

    function showAirdropModal() {
      const modal = document.getElementById('airdrop-modal');
      modal.style.display = 'block';
      modal.offsetHeight;
      modal.classList.add('active');
      // Сброс анимации текста
      const text = modal.querySelector('.airdrop-text');
      text.style.opacity = 0;
      text.style.animation = 'none';
      setTimeout(() => {
        text.style.animation = '';
        text.style.opacity = 1;
      }, 10);
    }
    function closeAirdropModal() {
      const modal = document.getElementById('airdrop-modal');
      modal.classList.remove('active');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }
    // Закрытие по клику вне окна
    window.addEventListener('click', function(event) {
      const modal = document.getElementById('airdrop-modal');
      if (event.target === modal) {
        closeAirdropModal();
      }
    });

    // Countdown Timer Logic
    function initializeCountdown() {
        // 6 May 2025, 17:00 MSK = 14:00 UTC
        const launchDateUTC = new Date(Date.UTC(2025, 4, 6, 14, 0, 0));
        function updateTimer() {
            const now = new Date();
            const timeLeft = launchDateUTC.getTime() - now.getTime();
            if (timeLeft <= 0) {
                document.getElementById('countdown-timer').innerHTML = "Token Launch Time!";
                return;
            }
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            const formattedHours = String(hours).padStart(2, '0');
            const formattedMinutes = String(minutes).padStart(2, '0');
            const formattedSeconds = String(seconds).padStart(2, '0');
            const timerElement = document.getElementById('countdown-timer');
            const newTime = `${formattedHours}h ${formattedMinutes}m ${formattedSeconds}s until token launch`;
            if (timerElement.innerHTML !== newTime) {
                timerElement.style.animation = 'none';
                timerElement.offsetHeight;
                timerElement.style.animation = null;
                timerElement.innerHTML = newTime;
            }
        }
        updateTimer();
        setInterval(updateTimer, 1000);
    }

    // Add event listener to initialize countdown when modal opens
    document.querySelector('.button[data-text="BUY $SLEEPMAN"]').addEventListener('click', function() {
        setTimeout(initializeCountdown, 100); // Small delay to ensure modal is rendered
    });

    function createBloodDrip(x, y) {
      const drip = document.createElement('div');
      drip.className = 'blood-drip';
      drip.style.left = x + 'px';
      drip.style.top = y + 'px';
      document.body.appendChild(drip);

      const duration = 2 + Math.random() * 3;
      const distance = 300 + Math.random() * 400;

      drip.style.animation = `bloodDrip ${duration}s ease-in forwards`;
      drip.style.transform = `translateY(${distance}px)`;

      drip.addEventListener('animationend', () => {
        createBloodSplash(x, y + distance);
        drip.remove();
      });
    }

    function createBloodSplash(x, y) {
      const splash = document.createElement('div');
      splash.className = 'blood-splash';
      splash.style.left = x + 'px';
      splash.style.top = y + 'px';
      document.body.appendChild(splash);

      setTimeout(() => splash.remove(), 2000);
    }

    function createCeilingDrips() {
      const width = window.innerWidth;
      for (let i = 0; i < 10; i++) {
        const x = Math.random() * width;
        createBloodDrip(x, -20);
      }
    }

    function triggerBloodEffect(event) {
      // Update warning message
      const warning = document.querySelector('.coin-warning');
      warning.textContent = "I warned you...";
      warning.classList.add('warning-glitch');
      
      // Hide warning after 30 seconds
      setTimeout(() => {
        warning.classList.add('hidden');
      }, 30000);

      // Play scream sound
      const scream = new Audio('corrupt-scream-312757.mp3');
      scream.volume = 0.6;
      scream.play().catch(error => console.error('Error playing sound:', error));

      // Add screen shake
      document.body.classList.add('screen-shake');
      setTimeout(() => {
        document.body.classList.remove('screen-shake');
      }, 2000);

      // Activate blood overlay
      const bloodOverlay = document.getElementById('blood-overlay');
      bloodOverlay.style.display = 'block';
      bloodOverlay.classList.add('active');

      // Create blood gush effect
      const bloodGush = document.createElement('div');
      bloodGush.className = 'blood-gush';
      bloodOverlay.appendChild(bloodGush);

      // Create blood splatter effect
      const bloodSplatter = document.createElement('div');
      bloodSplatter.className = 'blood-splatter';
      bloodOverlay.appendChild(bloodSplatter);

      // Activate screen distortion
      const screenDistortion = document.querySelector('.screen-distortion');
      screenDistortion.classList.add('active');

      // Add bleeding effect to coin
      const coin = event.currentTarget;
      coin.classList.add('bleeding');

      // Create intense blood drips from coin
      const rect = coin.getBoundingClientRect();
      const createCoinDrips = () => {
        for (let i = 0; i < 12; i++) {
          const x = rect.left + Math.random() * rect.width;
          const y = rect.bottom;
          createBloodDrip(x, y);
        }
      };

      // Create ceiling drips
      const createCeilingEffect = () => {
        createCeilingDrips();
      };

      // Create continuous effects
      const dripInterval = setInterval(createCoinDrips, 100);
      const ceilingInterval = setInterval(createCeilingEffect, 200);

      // Continue effects for 14 seconds
      setTimeout(() => {
        clearInterval(dripInterval);
        clearInterval(ceilingInterval);
      }, 14000);

      // Reset effects after 14 seconds
      setTimeout(() => {
        bloodOverlay.classList.remove('active');
        bloodOverlay.style.display = 'none';
        bloodOverlay.innerHTML = '';
        screenDistortion.classList.remove('active');
        coin.classList.remove('bleeding');
      }, 14000);
    }

    // Add click event listener to coin
    document.querySelector('.token-image').addEventListener('click', triggerBloodEffect);

    // JS-логика для работы с реферальным кодом и вводом
    let mainReferralCode = null;
    let enteredReferralCode = null;

    function openMainReferralModal() {
      const modal = document.getElementById('main-referral-modal');
      modal.style.display = 'block';
      modal.classList.add('active');
      updateReferralModalUI();
    }
    function closeMainReferralModal() {
      const modal = document.getElementById('main-referral-modal');
      modal.classList.remove('active');
      setTimeout(() => { modal.style.display = 'none'; }, 300);
    }

    function generate5DigitCode(address) {
      // address — строка (например, адрес кошелька)
      // генерируем 5-значный код на основе адреса (детерминированно)
      let hash = 0;
      for (let i = 0; i < address.length; i++) {
        hash = ((hash << 5) - hash) + address.charCodeAt(i);
        hash |= 0;
      }
      let code = Math.abs(hash % 100000).toString().padStart(5, '0');
      return code;
    }

    function updateReferralModalUI() {
      // Проверяем подключение кошелька
      const isConnected = typeof userAddress === 'string' && userAddress.length > 0;
      const codeBox = document.getElementById('main-referral-code');
      const input = document.getElementById('main-referral-input');
      const submitBtn = document.getElementById('main-referral-submit');
      const msg = document.getElementById('main-referral-msg');

      // Получаем/создаём свой код
      if (isConnected) {
        if (!mainReferralCode) {
          // Пробуем из localStorage
          mainReferralCode = localStorage.getItem('referral_code_' + userAddress);
          if (!mainReferralCode) {
            mainReferralCode = generate5DigitCode(userAddress);
            localStorage.setItem('referral_code_' + userAddress, mainReferralCode);
          }
        }
        codeBox.textContent = mainReferralCode;
      } else {
        codeBox.textContent = 'Connect wallet';
      }

      // Работа с вводом чужого кода
      if (isConnected) {
        input.disabled = false;
        submitBtn.disabled = false;
        // Проверяем, вводил ли уже код
        enteredReferralCode = localStorage.getItem('entered_referral_code_' + userAddress);
        if (enteredReferralCode) {
          input.value = enteredReferralCode;
          input.disabled = true;
          submitBtn.disabled = true;
          msg.textContent = 'You have already entered a code.';
        } else {
          input.value = '';
          msg.textContent = '';
        }
      } else {
        input.value = '';
        input.disabled = true;
        submitBtn.disabled = true;
        msg.textContent = 'Connect your wallet to enter a code.';
      }
    }

    document.getElementById('main-referral-submit').onclick = function() {
      const isConnected = typeof userAddress === 'string' && userAddress.length > 0;
      if (!isConnected) return;
      const input = document.getElementById('main-referral-input');
      const code = input.value.trim();
      const msg = document.getElementById('main-referral-msg');
      if (!/^[0-9]{5}$/.test(code)) {
        msg.textContent = 'Enter a valid 5-digit code.';
        return;
      }
      if (mainReferralCode && code === mainReferralCode) {
        msg.textContent = 'You cannot enter your own code.';
        return;
      }
      // Сохраняем введённый код
      localStorage.setItem('entered_referral_code_' + userAddress, code);
      updateReferralModalUI();
      msg.textContent = 'Code accepted!';
    };
  </script>
</body>
</html>
